generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = "file:./dev.db"
}

model Aisle {
  id        String       @id @default(cuid())
  name      String       @unique
  sortOrder Int
  ingredients Ingredient[]
}

model Unit {
  id            String        @id @default(cuid())
  name          String        @unique
  abbreviation  String
  ingredients   Ingredient[]
}

model Season {
  id               String             @id @default(cuid())
  name             String             @unique
  ingredients      IngredientSeason[]
  recipes          RecipeSeason[]
}

model Ingredient {
  id             String               @id @default(cuid())
  name           String               @unique
  defaultAisleId String
  unitId         String
  defaultAisle   Aisle                @relation(fields: [defaultAisleId], references: [id])
  unit           Unit                 @relation(fields: [unitId], references: [id])
  seasons        IngredientSeason[]
  recipeItems    RecipeIngredient[]
}

model IngredientSeason {
  ingredient   Ingredient @relation(fields: [ingredientId], references: [id])
  ingredientId String
  season       Season     @relation(fields: [seasonId], references: [id])
  seasonId     String

  @@id([ingredientId, seasonId])
}

model Recipe {
  id           String              @id @default(cuid())
  name         String
  totalMinutes Int
  sourceUrl    String?
  notes        String?
  seasons      RecipeSeason[]
  ingredients  RecipeIngredient[]
}

model RecipeSeason {
  recipe   Recipe @relation(fields: [recipeId], references: [id])
  recipeId String
  season   Season @relation(fields: [seasonId], references: [id])
  seasonId String

  @@id([recipeId, seasonId])
}

model RecipeIngredient {
  id           String     @id @default(cuid())
  recipe       Recipe     @relation(fields: [recipeId], references: [id])
  recipeId     String
  ingredient   Ingredient @relation(fields: [ingredientId], references: [id])
  ingredientId String
  quantity     Float
  note         String?
}
